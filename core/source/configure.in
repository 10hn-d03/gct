AC_REVISION($Revision$)
AC_INIT(Makefile.am)
AC_CONFIG_AUX_DIR(config)
AM_INIT_AUTOMAKE(,0)
AM_CONFIG_HEADER(globus_config.h)

LAC_COMPILERS_ARGS

AC_ARG_WITH(
    flavor,
    [  --with-flavor                 Globus flavor string],
    [globus_cv_flavor="$withval"],
    [globus_cv_flavor="notset"])

if test "$globus_cv_flavor" = "notset" \
     -o "$globus_cv_flavor" = "no" \
     -o "$globus_cv_flavor" = "yes" ; then
    AC_MSG_ERROR([A flavor description string must be specified!])
fi

dnl
dnl Gather information about our build environment
dnl
dnl NOTE: this needs to be done before AM_PROG_LIBTOOL is called
dnl
LAC_COMPILERS_TARGET(no)

dnl
dnl
dnl
save_LD=$LD
LD=
AM_PROG_LIBTOOL
LD=$save_LD

dnl
dnl Output selected thread package
dnl
GLOBUS_THREADS=$lac_cv_threads_type
if test "$GLOBUS_THREADS" = "no" ; then
    GLOBUS_THREADS=none
fi
AC_SUBST(GLOBUS_THREADS)


AC_OUTPUT(Makefile
          globus-build-env-${globus_cv_flavor}.sh:globus-build-env.sh.in)
