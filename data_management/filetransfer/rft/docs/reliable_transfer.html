<html>
<head>
  <title> RFT Service </title>
</head>

<body>

<img border="0" src="globus_top.gif" width="505" height="32"><br>
<img border="0" src="globus.gif" width="134" height="38"><img border="0" src="ogsadf.gif" width="530" height="34"><br>
<img border="0" src="globus_bottom.gif" width="100" height="32">

<h1> Reliable File Transfer Service Prototype </h1>

<p>The Reliable Transfer Service (RFT) allows you to monitor and control 3rd
party transfers using GridFTP servers. It is a reliable, and recoverable version
of the globus-url-copy tool (available in the current Globus Toolkit). The
client controlling the transfer is hosted inside of a Grid service and can thus
be managed using the soft state model, and queried using the introspection
techniques available to all Grid services. To set up the RFT services you need
to install Grid FTP from Globus Toolkit 2.0, and PostgreSQL.</p>
<h2>1 GridFTP Server Setup</h2>
<p>Download and install the Globus Toolkit 2.0 from <a href="http://www.globus.org/toolkit/download">here</a>. <br>
Start two GridFTP servers (one on the source host, and one on the destination
host of your transfer). <br>
Example:<br>
./in.ftpd -S [-p &lt;port&gt;]</p>
<p>Note the GridFTP server can only be run on Unix (or Linux) flavors.</p>
<h2>2 Postgres DB Setup</h2>
Postgres can be installed both on Unix and on Windows. For more detailed Unix
instructions see: <a href="http://www3.us.postgresql.org/sitess.html" EUDORA="AUTOURL">http://www3.us.postgresql.org/sitess.html</a>
and for more detailed Windows instructions see: <a href="http://www.ejip.net/faq/postgresql_win_setup_faq.jsp">http://www.ejip.net/faq/postgresql_win_setup_faq.jsp</a>
(Only first four steps are needed). Here is a summary of what you need to do
after installation:<h3>2.1 Unix Specific Setup</h3>
login as root<br>
adduser postgres<br>
mkdir /usr/local/pgsql/data<br>
chown postgres /usr/local/pgsql/data<br>
su - postgres<h3>2.2 Windows Specific Setup</h3>
To run postgres under Windows you need to install <a href="http://www.cygwin.com">Cygwin</a>,
and enable at least the following features:<br>
Database-&gt;postgresql<br>
Utils-&gt;bzip2<br>
Base-&gt;libreadline5<br>
<br>
After installing these components you also need to install CygIPC <a href="http://www.neuro.gatech.edu/users/cwilson/cygutils/cygipc/index.html">http://www.neuro.gatech.edu/users/cwilson/cygutils/cygipc/index.html</a>
<p>Now start the ipc_daemon from a cygwin shell e.g: <br>
/cygdrive/c/cygwin/usr/local/bin/ipc-daemon.exe &amp;</p>
<p>That's it, now you should be able to use psql and postgres as if on a Unix
machine. Note however that you will be using the username 'Administrator' as
opposed to 'postgres'</p>
<h3>2.3 Common Setup</h3>
<p>After completing either the Unix or Windows specific setup above do the
following from your user shell (postgres or Administrator)</p>
<p>export PGDATA=/usr/local/pgsql/data<br>
initdb<br>
createdb ogsa<br>
psql -d ogsa -f rft_schema_ogsa.sql (this file is provided in the ogsa
distribution root, under the etc directory) <br>
To start the db server run: pgctl -o&nbsp; &quot;-i&quot; -l logfile start
</p>
<h3>3 RFT Grid Service Setup
</h3>
<p> If you downloaded rft source code then you can make a deployable gar file using the following steps 
    o change the ogsacore.javadir property in build.xml to point to ogsa/impl/java directory in your  ogsa installation (or you can override the default property by doing ant -Dogsacore.dir=<your ogsa installation> compile)
    o Change the below mentioned parameters in reliabletransfer-server-config.wsdd
    o do ant stubs (in data_management/filetransfer/rft)
    o ant gar ( this builds a gar that can be deployed in a service container)
    o deploy the gar by running the following command in ogsa/impl/java 
    ant -f build-packages.xml deployClientServerGar -Dgar.name=<location of rft gar created in previous step>
<p>The following are the parameters you have to set in reliabletransfer-server-config.wsdd in
order to use Reliable File Transfer Service :<br>
<b>&nbsp;JdbcDriver</b> : Name of the JDBC Driver for the database you want to
use. For a PostgreSQL installation as described above this value is:
org.postgresql.Driver. The driver is shipped along with our distribution.<br>
<b>connectionURL</b>: URL for the Database in order make the connection. For
postgres this is jdbc:postgresql:&lt;db&gt;, and in our example above it would
be jdbc:postgresql:ogsa<br>
<b>username</b>: local user with access to the database. (On windows this would
be Administrator)&nbsp;<br>
<b>password</b> :password set up to access the database for the particular user<br>
</p>
<h2>4 Testing the Service with the ServiceBrowser Client
</h2>
1. In order to use sample RFT GUI client instead of Dynamic gui that is generated if no mapping is present in client-gui-config,xml(located in ogsa/impl/java) you have to add these mappings to the client-gui-config.xml before you run ant gui  
<panel portType="ReliableTransferPortType"
    class="org.globus.ogsa.gui.ReliableTransferPortTypePanel"/>
<panel serviceData="FileTransferProgress"
    class="org.globus.ogsa.gui.FileTransferProgressServiceDataPanel"/>
<panel serviceData="FileTransferRestartMarker"
    class="org.globus.ogsa.gui.FileTransferRestartMarkerServiceDataPanel"/>
2. Double click on the Deactivated RFT Factory instance that is listed in the
ServiceBrowser ContainerRegistryService<br>
2. Create an Instance of RFT from the RFT Factory.<br>
3. In the RFT GUI that shows up fill in From URL / To URL with valid gridftp
urls, which would look like this
<p>&nbsp;gsiftp://hostname/filename <br>
<br>
4.You can also specify number of parallel streams per transfer and set the TCP
Buffer size for the transfer<br>
5.Enable XML Signature/Encryption and Check Delegate Credentials check box.<br>
6.Submit Transfer.<br>
7. RFT is a persistent Reliable Transfer Service so if the service container
goes down while a transfer is going on the transfer is restarted next time you
start the service container when you activate the persistent instance.</p>

<h2> Service Data Elements for RFT </h2>
The percentage of file that has been transferred is exposed as Service Data.The percentage is calculated in two ways :1. using the Performance markers 2. Using the Restart Markers that are obtained during the course of the transfer.In the RFT gui you will notice two panels with JProgressBars indicating the percentage of file that has been transferred.
<br> Note: Performance Markers and Restart Markers are check points that are given out by girdftp servers indicating how much data has already been transferred.While Performance Markers contain more performance information,the Restart Markers are used to restart the transfer from that check point.
<br>
<br>
<br>
<br>
<br>
<br>

</body>
</html>
