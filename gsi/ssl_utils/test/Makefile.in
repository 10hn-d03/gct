
# Support obj directories
srcdir = @srcdir@
VPATH = @srcdir@

@makefile_default_rules@
@makefile_header@

THIS_DIR = Security/tests

@makefile_common_vars@

EXECS = @BUILD_TARGETS@
CLEAN_FILES = @BUILD_TARGETS@ server.log
DISTCLEAN_FILES = Makefile config.status config.log config.cache \
		run_security_tests.sh

MY_CFLAGS = -DUSE_AUTOCONF_H -DGSSAPI_V2 -I$(BUILD_DIR_INC) \
		-I$(BUILD_DIR_GSSAPI_SSLEAY) \
		$(GLOBUS_GSSAPI_CFLAGS) $(CFLAGS)
MY_LDFLAGS = -L$(BUILD_DIR_LIB) $(GLOBUS_GSSAPI_LDFLAGS) $(LDFLAGS)
MY_LIBS	= $(GLOBUS_GSSAPI_LIBS) $(LIBS)

@makefile_common_rules@
@makefile_link@


#
# gss-server and gss-client rules
#
gss-server$(EXECFILE): gss-server.$(OFILE) gss-misc.$(OFILE)
	$(PURIFY) $(LD) $(MY_LDFLAGS) \
	-o gss-server gss-server.$(OFILE) gss-misc.$(OFILE) \
	$(MY_LIBS)

gss-client$(EXECFILE): gss-client.$(OFILE) gss-misc.$(OFILE)
	$(PURIFY) $(LD) $(MY_LDFLAGS)  \
	-o gss-client gss-client.$(OFILE) gss-misc.$(OFILE) \
	$(MY_LIBS)

gss-assist-client$(EXECFILE): gss-assist-client.$(OFILE) gss-misc.$(OFILE)
	$(PURIFY) $(LD) $(MY_LDFLAGS) $(GLOBUS_NEXUS_LDFLAGS) \
	-o gss-assist-client gss-assist-client.$(OFILE) gss-misc.$(OFILE) \
	$(GLOBUS_GSSAPI_LIBS) $(GLOBUS_NEXUS_LIBS) $(LIBS)

gss-client.$(OFILE):	$(SRC_DIR_THIS)/gss-client.c
	$(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gss-client.c

gss-assist-client.$(OFILE):	$(SRC_DIR_THIS)/gss-assist-client.c
	$(CC) $(MY_CFLAGS) $(GLOBUS_NEXUS_CLFAGS) \
		-c $(SRC_DIR_THIS)/gss-assist-client.c

gss-misc.$(OFILE):	$(SRC_DIR_THIS)/gss-misc.c
	$(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gss-misc.c

gss-server.$(OFILE):	$(SRC_DIR_THIS)/gss-server.c
	$(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gss-server.c

#
# gssapi-om-uint-size-test rules
#

gssapi-om-uint-size-test-1$(EXECFILE): gssapi-om-uint-size-test-1.$(OFILE) 
        $(PURIFY) $(LD) $(MY_LDFLAGS)  \
        -o gssapi-om-uint-size-test-1 \
        gssapi-om-uint-size-test-1.$(OFILE) \
        $(MY_LIBS)

gssapi-om-uint-size-test-2$(EXECFILE): gssapi-om-uint-size-test-2.$(OFILE) 
        $(PURIFY) $(LD) $(MY_LDFLAGS)  \
        -o gssapi-om-uint-size-test-2 \
        gssapi-om-uint-size-test-2.$(OFILE) \
        $(MY_LIBS)

gssapi-om-uint-size-test.$(OFILE): $(SRC_DIR_THIS)/gssapi-om-uint-size-test.c
        $(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gssapi-om-uint-size-test.c

gssapi-om-uint-size-test-1.$(OFILE): $(SRC_DIR_THIS)/gssapi-om-uint-size-test-1.c
        $(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gssapi-om-uint-size-test-1.c

gssapi-om-uint-size-test-2.$(OFILE): $(SRC_DIR_THIS)/gssapi-om-uint-size-test-2.c
        $(CC) $(MY_CFLAGS) -c $(SRC_DIR_THIS)/gssapi-om-uint-size-test-2.c



