#! @SH@

condor_rm=@CONDOR_RM@
awk=@AWK@

arg_file=$1
# check for the argument file if it does not exist
# then return with an error immediately.
if [ ! -f $arg_file ] ; then
   echo GRAM_SCRIPT_ERROR:@GLOBUS_GRAM_CLIENT_ERROR_BAD_SCRIPT_ARG_FILE@
   exit 1
fi

# use the argument file to define all the arguments
. $arg_file

# if a logfile has been passed in then assume debug mode.
if [ $grami_logfile = "/dev/null" ] ; then
    DEBUG_ECHO=:
else
    DEBUG_ECHO=echo
fi

$DEBUG_ECHO "JM_SCRIPT: in gram_script_condor_rm" >> $grami_logfile

$DEBUG_ECHO "JM_SCRIPT: executing condor_rm command with job id "\
            "${_job_id}" >> $grami_logfile

status=`${condor_rm} ${grami_job_id} | ${awk} -F. '{print $1}'`

if [ "${status}" = "Deleted ${grami_job_id}" ] ; then
#   the job manager only cares about GRAM_SCRIPT_SUCCESS or
#   GRAM_SCRIPT_ERROR from this script.  The value is inconsiquencial.
    echo GRAM_SCRIPT_SUCCESS:999
else
    echo GRAM_SCRIPT_ERROR:@GLOBUS_GRAM_CLIENT_ERROR_JOB_CANCEL_FAILED@
fi

$DEBUG_ECHO "JM_SCRIPT: exiting gram_script_condor_rm" >> $grami_logfile
